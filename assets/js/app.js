!function(){"use strict";const e={normalizePhone:e=>e?e.replace(/[^0-9]/g,""):"",isValidPhone(e){const t=this.normalizePhone(e);return!(t.length<10||t.length>11)&&t.startsWith("01")},formatPhone(e){const t=this.normalizePhone(e);return t.length<=3?t:t.length<=7?`${t.slice(0,3)}-${t.slice(3)}`:`${t.slice(0,3)}-${t.slice(3,7)}-${t.slice(7,11)}`}},t={KEY_PREFIX:"ttbt_event_",memoryStorage:{},isLocalStorageAvailable(){try{const e="__storage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}},getItem(e){return this.isLocalStorageAvailable()?localStorage.getItem(e):this.memoryStorage[e]||null},setItem(e,t){if(this.isLocalStorageAvailable())try{localStorage.setItem(e,t)}catch(n){this.memoryStorage[e]=t}else this.memoryStorage[e]=t},hasParticipated(e){return!!e&&null!==this.getItem(this.KEY_PREFIX+e)},markParticipated(e,t){if(!e)return;const n={phone:e,prize:t,timestamp:(new Date).toISOString()};this.setItem(this.KEY_PREFIX+e,JSON.stringify(n))},getParticipation(e){if(!e)return null;const t=this.getItem(this.KEY_PREFIX+e);try{return t?JSON.parse(t):null}catch(e){return null}}},n={PRIZES:["ì „ ì‹œìˆ  10% í• ì¸","íŠ¸ë¦¬íŠ¸ë¨¼íŠ¸ ë¬´ë£Œ ì¿ í°","5,000ì› í• ì¸","íŠ¸ë¦¬íŠ¸ë¨¼íŠ¸ 50% í• ì¸"],WEIGHTED_PRIZES:["íŠ¸ë¦¬íŠ¸ë¨¼íŠ¸ 50% í• ì¸","íŠ¸ë¦¬íŠ¸ë¨¼íŠ¸ 50% í• ì¸","íŠ¸ë¦¬íŠ¸ë¨¼íŠ¸ 50% í• ì¸","íŠ¸ë¦¬íŠ¸ë¨¼íŠ¸ 50% í• ì¸","íŠ¸ë¦¬íŠ¸ë¨¼íŠ¸ 50% í• ì¸","íŠ¸ë¦¬íŠ¸ë¨¼íŠ¸ 50% í• ì¸","íŠ¸ë¦¬íŠ¸ë¨¼íŠ¸ 50% í• ì¸","íŠ¸ë¦¬íŠ¸ë¨¼íŠ¸ 50% í• ì¸","ì „ ì‹œìˆ  10% í• ì¸","ì „ ì‹œìˆ  10% í• ì¸","ì „ ì‹œìˆ  10% í• ì¸","ì „ ì‹œìˆ  10% í• ì¸","5,000ì› í• ì¸","5,000ì› í• ì¸","5,000ì› í• ì¸","íŠ¸ë¦¬íŠ¸ë¨¼íŠ¸ ë¬´ë£Œ ì¿ í°"],PRIZE_STOP_ANGLES:{"ì „ ì‹œìˆ  10% í• ì¸":45,"íŠ¸ë¦¬íŠ¸ë¨¼íŠ¸ ë¬´ë£Œ ì¿ í°":315,"5,000ì› í• ì¸":225,"íŠ¸ë¦¬íŠ¸ë¨¼íŠ¸ 50% í• ì¸":135},isSpinning:!1,currentRotation:0,selectPrize(){return this.WEIGHTED_PRIZES[Math.floor(Math.random()*this.WEIGHTED_PRIZES.length)]},calculateStopAngle(e){return this.PRIZE_STOP_ANGLES[e]+40*(Math.random()-.5)},spin(e){if(this.isSpinning)return;this.isSpinning=!0;const t=document.getElementById("roulette-wheel"),n=document.getElementById("spin-btn");n.disabled=!0,n.textContent="...";const i=this.selectPrize(),o=3+Math.floor(3*Math.random()),s=this.calculateStopAngle(i),r=this.currentRotation+360*o+s;t.style.transition="transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99)",t.style.transform=`rotate(${r}deg)`,this.currentRotation=r,setTimeout(()=>{this.isSpinning=!1,n.textContent="START",e&&e(i)},4e3)},reset(){const e=document.getElementById("roulette-wheel");e.style.transition="none",e.style.transform="rotate(0deg)",this.currentRotation=0,this.isSpinning=!1;const t=document.getElementById("spin-btn");t.disabled=!1,t.textContent="START"}},i={currentPhone:"",elements:{},cacheElements(){this.elements={phoneForm:document.getElementById("phone-form"),phoneInput:document.getElementById("phone-input"),phoneError:document.getElementById("phone-error"),consentCheck:document.getElementById("consent-check"),consentToggle:document.getElementById("consent-toggle"),consentContent:document.getElementById("consent-content"),submitBtn:document.getElementById("submit-btn"),rouletteSection:document.getElementById("roulette-section"),spinBtn:document.getElementById("spin-btn"),rouletteResult:document.getElementById("roulette-result"),prizeText:document.getElementById("prize-text"),resultPhone:document.getElementById("result-phone")}},showError(e){this.elements.phoneError.textContent=e,this.elements.phoneError.classList.add("show"),this.elements.phoneInput.focus()},hideError(){this.elements.phoneError.classList.remove("show")},scrollToRoulette(){this.elements.rouletteSection.classList.add("active"),setTimeout(()=>{this.elements.rouletteSection.scrollIntoView({behavior:"smooth",block:"center"})},100)},showResult(t,n=!1,i=null){this.elements.prizeText.textContent=t,this.elements.rouletteResult.classList.add("show");const o=document.querySelector(".roulette-result__title"),s=document.querySelector(".roulette-result__icon"),r=i||this.currentPhone;r&&this.elements.resultPhone&&(this.elements.resultPhone.textContent=e.formatPhone(r)),n?(o.textContent="ì´ë¯¸ ì°¸ì—¬í•˜ì…¨ìŠµë‹ˆë‹¤!",s.textContent="ðŸ“‹"):(o.textContent="ì¶•í•˜í•©ë‹ˆë‹¤!",s.textContent="ðŸŽ‰"),setTimeout(()=>{this.elements.rouletteResult.scrollIntoView({behavior:"smooth",block:"center"})},300)},showPreviousResult(e,t){this.elements.rouletteSection.classList.add("active");const n=document.querySelector(".roulette-container"),i=document.querySelectorAll(".roulette-title"),o=document.querySelector(".roulette-desc");n.style.display="none",i[0].textContent="ì´ì „ ì°¸ì—¬ ë‚´ì—­",i[1].style.display="none",o.textContent="ì´ë¯¸ ì´ë²¤íŠ¸ì— ì°¸ì—¬í•˜ì…¨ìŠµë‹ˆë‹¤",this.showResult(e,!0,t),setTimeout(()=>{this.elements.rouletteSection.scrollIntoView({behavior:"smooth",block:"center"})},100)},initConsent(){this.elements.consentToggle.addEventListener("click",()=>{const e=this.elements.consentContent.classList.toggle("open");this.elements.consentToggle.textContent=e?"ë‹«ê¸°":"ë³´ê¸°"}),this.elements.consentCheck.addEventListener("change",()=>{this.elements.submitBtn.disabled=!this.elements.consentCheck.checked})},initPhoneForm(){this.elements.phoneInput.addEventListener("input",t=>{this.hideError(),t.target.value=e.formatPhone(t.target.value)}),this.elements.phoneForm.addEventListener("submit",n=>{if(n.preventDefault(),!this.elements.consentCheck.checked)return void this.showError("ê°œì¸ì •ë³´ ë§ˆì¼€íŒ… í™œìš©ì— ë™ì˜í•´ì£¼ì„¸ìš”");const i=this.elements.phoneInput.value,o=e.normalizePhone(i);if(!e.isValidPhone(o))return void this.showError("ì˜¬ë°”ë¥¸ ì „í™”ë²ˆí˜¸ë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš” (ì˜ˆ: 010-1234-5678)");if(t.hasParticipated(o)){const e=t.getParticipation(o),n=e?e.prize:"í˜œíƒ";return this.hideError(),void this.showPreviousResult(n,o)}this.currentPhone=o,this.hideError(),this.scrollToRoulette()})},initRoulette(){this.elements.spinBtn.addEventListener("click",()=>{n.isSpinning||n.spin(e=>{this.showResult(e),t.markParticipated(this.currentPhone,e),this.elements.spinBtn.disabled=!0,this.elements.spinBtn.textContent="ì™„ë£Œ"})})},init(){this.cacheElements(),this.initConsent(),this.initPhoneForm(),this.initRoulette()}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>i.init()):i.init()}();
